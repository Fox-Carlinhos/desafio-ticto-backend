{
    "info": {
        "name": "Ticto Time Tracking API",
        "description": "API completa para sistema de controle de ponto da Ticto\n\n**Instru√ß√µes de uso:**\n1. Configure a vari√°vel baseUrl para http://localhost:8000/api\n2. Execute primeiro o endpoint de Login\n3. O token ser√° automaticamente salvo e usado em todas as outras requisi√ß√µes\n4. Endpoints protegidos requerem autentica√ß√£o\n5. Endpoints de administra√ß√£o requerem perfil de admin\n6. Endpoints de funcion√°rio requerem perfil de employee\n\n**Credenciais de teste:**\n- Admin: admin@ticto.com.br / admin123\n- Funcion√°rio: carlos.santos@ticto.com.br / carlos123",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:8000/api",
            "type": "string"
        },
        {
            "key": "token",
            "value": "",
            "type": "string"
        }
    ],
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{token}}",
                "type": "string"
            }
        ]
    },
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "exec": [
                    "// Script para verificar se h√° token salvo",
                    "if (!pm.collectionVariables.get(\"token\") && !pm.request.url.getPath().includes('/login')) {",
                    "    console.log('‚ö†Ô∏è Token n√£o encontrado. Execute o endpoint de Login primeiro.');",
                    "}"
                ],
                "type": "text/javascript"
            }
        }
    ],
    "item": [
        {
            "name": "Authentication",
            "description": "Endpoints para autentica√ß√£o e gerenciamento de sess√£o",
            "item": [
                {
                    "name": "Login",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "// Salvar token automaticamente ap√≥s login bem-sucedido",
                                    "pm.test(\"Login realizado com sucesso\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "    ",
                                    "    const responseJson = pm.response.json();",
                                    "    pm.expect(responseJson.success).to.be.true;",
                                    "    ",
                                    "    if (responseJson.data && responseJson.data.access_token) {",
                                    "        pm.collectionVariables.set(\"token\", responseJson.data.access_token);",
                                    "        console.log(\"‚úÖ Token salvo automaticamente!\");",
                                    "        console.log(\"üéâ Agora voc√™ pode usar todos os outros endpoints!\");",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"admin@ticto.com.br\",\n  \"password\": \"admin123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/login",
                            "host": ["{{baseUrl}}"],
                            "path": ["login"]
                        },
                        "description": "Fazer login no sistema e obter token de acesso.\n\n**Credenciais dispon√≠veis:**\n- Admin: admin@ticto.com.br / admin123\n- Funcion√°rio: carlos.santos@ticto.com.br / carlos123\n\n**Resposta de sucesso:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Login realizado com sucesso\",\n  \"data\": {\n    \"access_token\": \"1|xxxx\",\n    \"token_type\": \"Bearer\",\n    \"user\": {\n      \"id\": 1,\n      \"name\": \"Administrador Ticto\",\n      \"email\": \"admin@ticto.com.br\",\n      \"role\": \"admin\"\n    }\n  }\n}\n```"
                    }
                },
                {
                    "name": "Me (Usu√°rio Atual)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/me",
                            "host": ["{{baseUrl}}"],
                            "path": ["me"]
                        },
                        "description": "Obter informa√ß√µes do usu√°rio autenticado atualmente."
                    }
                },
                {
                    "name": "Logout",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "// Limpar token ap√≥s logout",
                                    "pm.test(\"Logout realizado com sucesso\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "    pm.collectionVariables.set(\"token\", \"\");",
                                    "    console.log(\"üîì Token removido. Fa√ßa login novamente para usar outros endpoints.\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/logout",
                            "host": ["{{baseUrl}}"],
                            "path": ["logout"]
                        },
                        "description": "Fazer logout e revogar o token atual."
                    }
                },
                {
                    "name": "Alterar Senha",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"current_password\": \"password\",\n  \"new_password\": \"nova_senha_123\",\n  \"new_password_confirmation\": \"nova_senha_123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/change-password",
                            "host": ["{{baseUrl}}"],
                            "path": ["change-password"]
                        },
                        "description": "Alterar a senha do usu√°rio autenticado."
                    }
                }
            ]
        },
        {
            "name": "Gest√£o de Funcion√°rios (Admin)",
            "description": "Endpoints para administradores gerenciarem funcion√°rios",
            "item": [
                {
                    "name": "Listar Funcion√°rios",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/employees?search=&manager_id=&page=1",
                            "host": ["{{baseUrl}}"],
                            "path": ["employees"],
                            "query": [
                                {
                                    "key": "search",
                                    "value": "",
                                    "description": "Buscar por nome, CPF, cargo ou email"
                                },
                                {
                                    "key": "manager_id",
                                    "value": "",
                                    "description": "Filtrar por gestor"
                                },
                                {
                                    "key": "page",
                                    "value": "1",
                                    "description": "P√°gina (pagina√ß√£o)"
                                }
                            ]
                        },
                        "description": "Listar todos os funcion√°rios com pagina√ß√£o e filtros.\n\n**Par√¢metros opcionais:**\n- `search`: Buscar por nome, CPF, cargo ou email (ex: Carlos, Ana, Designer)\n- `manager_id`: Filtrar funcion√°rios por gestor (ex: 1, 2)\n- `page`: N√∫mero da p√°gina (padr√£o: 1)\n\n**Dados dispon√≠veis:**\n- Funcion√°rios criados pelo seeder incluem Carlos Santos, Ana Oliveira, etc.\n- Gestores dispon√≠veis: ID 1 (admin@ticto.com.br), ID 2 (joao.silva@ticto.com.br)"
                    }
                },
                {
                    "name": "Criar Funcion√°rio",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Roberto Lima\",\n  \"email\": \"roberto.lima@ticto.com.br\",\n  \"password\": \"roberto123\",\n  \"full_name\": \"Roberto Lima Silva\",\n  \"cpf\": \"98765432100\",\n  \"position\": \"Analista de Sistemas\",\n  \"birth_date\": \"1988-11-20\",\n  \"cep\": \"13040123\",\n  \"number\": \"456\",\n  \"complement\": \"Sala 12\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/employees",
                            "host": ["{{baseUrl}}"],
                            "path": ["employees"]
                        },
                        "description": "Cadastrar um novo funcion√°rio no sistema.\n\n**Campos obrigat√≥rios:**\n- `name`: Nome para login\n- `email`: Email √∫nico\n- `password`: Senha (m√≠n. 6 caracteres)\n- `full_name`: Nome completo\n- `cpf`: CPF v√°lido (11 d√≠gitos)\n- `position`: Cargo\n- `birth_date`: Data de nascimento (YYYY-MM-DD)\n- `cep`: CEP v√°lido (8 d√≠gitos)\n\n**Campos opcionais:**\n- `number`: N√∫mero do endere√ßo\n- `complement`: Complemento do endere√ßo"
                    }
                },
                {
                    "name": "Visualizar Funcion√°rio",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/employees/1",
                            "host": ["{{baseUrl}}"],
                            "path": ["employees", "1"]
                        },
                        "description": "Visualizar detalhes completos de um funcion√°rio espec√≠fico."
                    }
                },
                {
                    "name": "Atualizar Funcion√°rio",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Carlos Eduardo Santos\",\n  \"email\": \"carlos.eduardo@ticto.com.br\",\n  \"full_name\": \"Carlos Eduardo Santos Silva\",\n  \"position\": \"Desenvolvedor Full Stack Pleno\",\n  \"is_active\": true\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/employees/1",
                            "host": ["{{baseUrl}}"],
                            "path": ["employees", "1"]
                        },
                        "description": "Atualizar dados de um funcion√°rio existente.\n\n**Todos os campos s√£o opcionais (PATCH-like):**\n- Dados do usu√°rio: `name`, `email`, `password`, `is_active`\n- Dados do funcion√°rio: `full_name`, `cpf`, `position`, `birth_date`\n- Dados do endere√ßo: `cep`, `number`, `complement`"
                    }
                },
                {
                    "name": "Excluir Funcion√°rio",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/employees/1",
                            "host": ["{{baseUrl}}"],
                            "path": ["employees", "1"]
                        },
                        "description": "Excluir um funcion√°rio do sistema (exclus√£o em cascata)."
                    }
                }
            ]
        },
        {
            "name": "Relat√≥rios (Admin)",
            "description": "Endpoints para gera√ß√£o de relat√≥rios (apenas admins)",
            "item": [
                {
                    "name": "Relat√≥rio de Registros de Ponto",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/reports/time-records?start_date=2025-05-01&end_date=2025-08-23&employee_id=&manager_id=&per_page=20&page=1",
                            "host": ["{{baseUrl}}"],
                            "path": ["reports", "time-records"],
                            "query": [
                                {
                                    "key": "start_date",
                                    "value": "2025-05-01",
                                    "description": "Data inicial (YYYY-MM-DD)"
                                },
                                {
                                    "key": "end_date",
                                    "value": "2025-08-23",
                                    "description": "Data final (YYYY-MM-DD)"
                                },
                                {
                                    "key": "employee_id",
                                    "value": "",
                                    "description": "ID do funcion√°rio espec√≠fico"
                                },
                                {
                                    "key": "manager_id",
                                    "value": "",
                                    "description": "ID do gestor"
                                },
                                {
                                    "key": "per_page",
                                    "value": "20",
                                    "description": "Registros por p√°gina (1-100)"
                                },
                                {
                                    "key": "page",
                                    "value": "1",
                                    "description": "N√∫mero da p√°gina"
                                }
                            ]
                        },
                        "description": "Relat√≥rio detalhado de registros de ponto usando SQL puro.\n\n**Campos retornados:**\n- ID do Registro\n- Nome do Funcion√°rio\n- Cargo\n- Idade\n- Nome do Gestor\n- Data e Hora Completa (com segundos)\n\n**Filtros dispon√≠veis:**\n- Per√≠odo (start_date/end_date)\n- Funcion√°rio espec√≠fico\n- Gestor espec√≠fico\n- Pagina√ß√£o"
                    }
                },
                {
                    "name": "Resumo Estat√≠stico",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/reports/summary?start_date=2025-05-01&end_date=2025-08-23",
                            "host": ["{{baseUrl}}"],
                            "path": ["reports", "summary"],
                            "query": [
                                {
                                    "key": "start_date",
                                    "value": "2025-05-01",
                                    "description": "Data inicial (YYYY-MM-DD)"
                                },
                                {
                                    "key": "end_date",
                                    "value": "2025-08-23",
                                    "description": "Data final (YYYY-MM-DD)"
                                }
                            ]
                        },
                        "description": "Resumo estat√≠stico com m√©tricas consolidadas do sistema."
                    }
                },
                {
                    "name": "Exportar Relat√≥rio",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/reports/export?format=csv&start_date=2025-05-01&end_date=2025-08-23",
                            "host": ["{{baseUrl}}"],
                            "path": ["reports", "export"],
                            "query": [
                                {
                                    "key": "format",
                                    "value": "csv",
                                    "description": "Formato de exporta√ß√£o (csv, excel)"
                                },
                                {
                                    "key": "start_date",
                                    "value": "2025-05-01",
                                    "description": "Data inicial"
                                },
                                {
                                    "key": "end_date",
                                    "value": "2025-08-23",
                                    "description": "Data final"
                                }
                            ]
                        },
                        "description": "Exportar relat√≥rios em diferentes formatos (CSV, Excel, etc.)."
                    }
                }
            ]
        },
        {
            "name": "Registro de Ponto (Funcion√°rios)",
            "description": "Endpoints para funcion√°rios registrarem ponto",
            "item": [
                {
                    "name": "Registrar Ponto",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"type\": \"entry\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{baseUrl}}/time-records",
                            "host": ["{{baseUrl}}"],
                            "path": ["time-records"]
                        },
                        "description": "Registrar entrada ou sa√≠da no sistema de ponto.\n\n**Tipos dispon√≠veis:**\n- `entry`: Entrada (normalmente entre 7h-9h)\n- `exit`: Sa√≠da (normalmente entre 17h-19h)\n- `break_start`: In√≠cio do intervalo (normalmente entre 11h-13h)\n- `break_end`: Fim do intervalo (normalmente entre 13h-14h)\n\n**Valida√ß√µes autom√°ticas:**\n- N√£o permite registros duplicados no mesmo momento\n- Valida sequ√™ncia l√≥gica dos registros\n- Controla intervalos m√≠nimos entre registros\n\n**Nota:** Sistema j√° possui registros dos √∫ltimos 3 meses (maio-agosto 2025)"
                    }
                },
                {
                    "name": "Meus Registros de Ponto",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/time-records?start_date=2025-05-01&end_date=2025-08-23&page=1",
                            "host": ["{{baseUrl}}"],
                            "path": ["time-records"],
                            "query": [
                                {
                                    "key": "start_date",
                                    "value": "2025-05-01",
                                    "description": "Data inicial (YYYY-MM-DD)"
                                },
                                {
                                    "key": "end_date",
                                    "value": "2025-08-23",
                                    "description": "Data final (YYYY-MM-DD)"
                                },
                                {
                                    "key": "page",
                                    "value": "1",
                                    "description": "P√°gina"
                                }
                            ]
                        },
                        "description": "Listar meus pr√≥prios registros de ponto com filtros de data."
                    }
                },
                {
                    "name": "Resumo dos Meus Registros",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/time-records/summary?start_date=2025-05-01&end_date=2025-08-23",
                            "host": ["{{baseUrl}}"],
                            "path": ["time-records", "summary"],
                            "query": [
                                {
                                    "key": "start_date",
                                    "value": "2025-05-01",
                                    "description": "Data inicial"
                                },
                                {
                                    "key": "end_date",
                                    "value": "2025-08-23",
                                    "description": "Data final"
                                }
                            ]
                        },
                        "description": "Resumo consolidado dos meus registros com horas trabalhadas, atrasos, etc."
                    }
                },
                {
                    "name": "Status do Dia Atual",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Accept",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/time-records/today",
                            "host": ["{{baseUrl}}"],
                            "path": ["time-records", "today"]
                        },
                        "description": "Verificar status atual do ponto do dia (√∫ltimo registro, pr√≥ximo tipo permitido, etc.)."
                    }
                }
            ]
        }
    ]
}
